{
  "version": 3,
  "sources": ["../src/utils/folder-exclusion.ts"],
  "sourcesContent": [
    "/**\r\n * Folder exclusion utilities\r\n *\r\n * Handles checking if a folder path is excluded from Zest tracking\r\n */\r\n\r\nimport { normalize, resolve, sep } from \"node:path\";\r\nimport type { UserSettings } from \"../config/settings.js\";\r\n\r\n/**\r\n * Check if the current platform uses case-insensitive filesystem\r\n */\r\nfunction isCaseInsensitiveFilesystem(): boolean {\r\n  return process.platform === \"win32\" || process.platform === \"darwin\";\r\n}\r\n\r\n/**\r\n * Normalize path for comparison, handling case-insensitive filesystems\r\n */\r\nfunction normalizeForComparison(path: string): string {\r\n  const normalized = normalize(resolve(path));\r\n  return isCaseInsensitiveFilesystem() ? normalized.toLowerCase() : normalized;\r\n}\r\n\r\n/**\r\n * Check if a folder path is excluded from tracking\r\n *\r\n * @param folderPath - The folder path to check\r\n * @param settings - User settings containing excludedFolders list\r\n * @returns true if the folder (or any parent) is in the exclusion list\r\n */\r\nexport function isFolderExcluded(folderPath: string, settings: UserSettings): boolean {\r\n  const comparePath = normalizeForComparison(folderPath);\r\n  const separatorForComparison = isCaseInsensitiveFilesystem() ? sep.toLowerCase() : sep;\r\n\r\n  return settings.excludedFolders.some((excluded) => {\r\n    const compareExcluded = normalizeForComparison(excluded);\r\n    // Check if path equals or is inside excluded folder\r\n    return (\r\n      comparePath === compareExcluded ||\r\n      comparePath.startsWith(compareExcluded + separatorForComparison)\r\n    );\r\n  });\r\n}\r\n\r\n/**\r\n * Add a folder to the exclusion list\r\n *\r\n * @param folderPath - The folder path to exclude\r\n * @param settings - User settings to modify\r\n * @returns Updated settings with the folder added (or unchanged if already present)\r\n */\r\nexport function addExcludedFolder(\r\n  folderPath: string,\r\n  settings: UserSettings,\r\n): { settings: UserSettings; alreadyExcluded: boolean } {\r\n  const normalizedPath = normalize(resolve(folderPath));\r\n  const comparePath = normalizeForComparison(folderPath);\r\n\r\n  // Check if already excluded (case-insensitive on Windows/macOS)\r\n  const alreadyExists = settings.excludedFolders.some(\r\n    (f) => normalizeForComparison(f) === comparePath,\r\n  );\r\n\r\n  if (alreadyExists) {\r\n    return { settings, alreadyExcluded: true };\r\n  }\r\n\r\n  return {\r\n    settings: {\r\n      ...settings,\r\n      excludedFolders: [...settings.excludedFolders, normalizedPath],\r\n    },\r\n    alreadyExcluded: false,\r\n  };\r\n}\r\n\r\n/**\r\n * Remove a folder from the exclusion list\r\n *\r\n * @param folderPath - The folder path to remove from exclusion\r\n * @param settings - User settings to modify\r\n * @returns Updated settings with the folder removed (or unchanged if not present)\r\n */\r\nexport function removeExcludedFolder(\r\n  folderPath: string,\r\n  settings: UserSettings,\r\n): { settings: UserSettings; wasExcluded: boolean } {\r\n  const comparePath = normalizeForComparison(folderPath);\r\n\r\n  // Find and remove matching folder (case-insensitive on Windows/macOS)\r\n  const matchIndex = settings.excludedFolders.findIndex(\r\n    (f) => normalizeForComparison(f) === comparePath,\r\n  );\r\n\r\n  if (matchIndex === -1) {\r\n    return { settings, wasExcluded: false };\r\n  }\r\n\r\n  return {\r\n    settings: {\r\n      ...settings,\r\n      excludedFolders: settings.excludedFolders.filter((_, i) => i !== matchIndex),\r\n    },\r\n    wasExcluded: true,\r\n  };\r\n}\r\n"
  ],
  "mappings": ";AAMA;AAMA,SAAS,2BAA2B,GAAY;AAAA,EAC9C,OAAO,QAAQ,aAAa,WAAW,QAAQ,aAAa;AAAA;AAM9D,SAAS,sBAAsB,CAAC,MAAsB;AAAA,EACpD,MAAM,aAAa,UAAU,QAAQ,IAAI,CAAC;AAAA,EAC1C,OAAO,4BAA4B,IAAI,WAAW,YAAY,IAAI;AAAA;AAU7D,SAAS,gBAAgB,CAAC,YAAoB,UAAiC;AAAA,EACpF,MAAM,cAAc,uBAAuB,UAAU;AAAA,EACrD,MAAM,yBAAyB,4BAA4B,IAAI,IAAI,YAAY,IAAI;AAAA,EAEnF,OAAO,SAAS,gBAAgB,KAAK,CAAC,aAAa;AAAA,IACjD,MAAM,kBAAkB,uBAAuB,QAAQ;AAAA,IAEvD,OACE,gBAAgB,mBAChB,YAAY,WAAW,kBAAkB,sBAAsB;AAAA,GAElE;AAAA;AAUI,SAAS,iBAAiB,CAC/B,YACA,UACsD;AAAA,EACtD,MAAM,iBAAiB,UAAU,QAAQ,UAAU,CAAC;AAAA,EACpD,MAAM,cAAc,uBAAuB,UAAU;AAAA,EAGrD,MAAM,gBAAgB,SAAS,gBAAgB,KAC7C,CAAC,MAAM,uBAAuB,CAAC,MAAM,WACvC;AAAA,EAEA,IAAI,eAAe;AAAA,IACjB,OAAO,EAAE,UAAU,iBAAiB,KAAK;AAAA,EAC3C;AAAA,EAEA,OAAO;AAAA,IACL,UAAU;AAAA,SACL;AAAA,MACH,iBAAiB,CAAC,GAAG,SAAS,iBAAiB,cAAc;AAAA,IAC/D;AAAA,IACA,iBAAiB;AAAA,EACnB;AAAA;AAUK,SAAS,oBAAoB,CAClC,YACA,UACkD;AAAA,EAClD,MAAM,cAAc,uBAAuB,UAAU;AAAA,EAGrD,MAAM,aAAa,SAAS,gBAAgB,UAC1C,CAAC,MAAM,uBAAuB,CAAC,MAAM,WACvC;AAAA,EAEA,IAAI,eAAe,IAAI;AAAA,IACrB,OAAO,EAAE,UAAU,aAAa,MAAM;AAAA,EACxC;AAAA,EAEA,OAAO;AAAA,IACL,UAAU;AAAA,SACL;AAAA,MACH,iBAAiB,SAAS,gBAAgB,OAAO,CAAC,GAAG,MAAM,MAAM,UAAU;AAAA,IAC7E;AAAA,IACA,aAAa;AAAA,EACf;AAAA;",
  "debugId": "6B33F46D18F0560464756E2164756E21",
  "names": []
}